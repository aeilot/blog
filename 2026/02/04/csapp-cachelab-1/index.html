<!DOCTYPE html>
<html lang="en-US">
  <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>CSAPP Cache Lab I: Let&#39;s simulate a cache memory! - Louis C Deng&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
  <link rel='manifest' href='/manifest.json'>
  

  <meta name="description" content="For the CSAPP Cache Lab, the students are asked to write a small C program (200~300 lines) that simulates a cache memory. The full code is here on GitHub.  Understanding a Cache  1. The Anatomy of a C">
<meta property="og:type" content="article">
<meta property="og:title" content="CSAPP Cache Lab I: Let&#39;s simulate a cache memory!">
<meta property="og:url" content="https://blog.aeilot.top/2026/02/04/csapp-cachelab-1/index.html">
<meta property="og:site_name" content="Louis C Deng&#39;s Blog">
<meta property="og:description" content="For the CSAPP Cache Lab, the students are asked to write a small C program (200~300 lines) that simulates a cache memory. The full code is here on GitHub.  Understanding a Cache  1. The Anatomy of a C">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2026-02-04T16:45:09.000Z">
<meta property="article:modified_time" content="2026-02-04T16:37:31.184Z">
<meta property="article:author" content="Louis C Deng">
<meta property="article:tag" content="Architecture">
<meta property="article:tag" content="CSAPP">
<meta property="article:tag" content="Lab Notes">
<meta name="twitter:card" content="summary">

  <script>window.ThemeCupertino = {}</script>

  <link rel="preconnect" href="https://rsms.me/">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  
  
<link rel="stylesheet" href="https://unpkg.com/simple-icons-font@16/font/simple-icons.min.css">

  
  
  
<link rel="stylesheet" href="https://unpkg.com/bootstrap-icons@1/font/bootstrap-icons.min.css">

  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">


  
  
<link rel="stylesheet" href="/css/components/card.css">

  
  
  
<link rel="stylesheet" href="/css/components/button.css">

  
  
  
<link rel="stylesheet" href="/css/components/badge.css">

  
  
  
<link rel="stylesheet" href="/css/components/utilities.css">

  
  
  
<link rel="stylesheet" href="/css/components/carousel.css">

  
  
  <script>ThemeCupertino['_calloutStyles'] = `
<link rel="stylesheet" href="/css/components/callout.css">
`</script>
  
<script src="/js/components/callout.js"></script>

  

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  
  
  
<link rel="stylesheet" href="/css/scroll-reveal.css">

  
  
  
<link rel="stylesheet" href="/css/view-transition.css">

  
  

  
<script src="/js/head.js"></script>

  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head>

  <body
    data-color-scheme="auto"
    data-uppercase-categories="true"
    
    data-rainbow-banner="true"
    data-rainbow-banner-shown="auto"
    data-rainbow-banner-month="6"
    data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
    
    data-config-root="/"
    
    data-toc="true"
    data-toc-max-depth="2"
    
    
    
    data-scroll-reveal-disappear="false"
    data-scroll-reveal-query=".scroll-reveal, .post-list-item, .card, .content p img, .content .block-large img"
    
    data-nav-blur-gradient="true"
    style="--config-corner-squircle: true"
  >
    
<script src="/js/body-top.js"></script>

    <a href="#main-content" id="skip-to-content">Skip to content</a>
    

<div class="nav-mask">
  
  <div style="--sharp: 1"></div>
  
  <div style="--sharp: 2"></div>
  
  <div style="--sharp: 3"></div>
  
  <div style="--sharp: 4"></div>
  
  <div style="--sharp: 5"></div>
  
  <div style="--sharp: 6"></div>
  
</div>

<nav id="theme-nav">
  <div class="inner">
    <a class="title" href="/">Blog</a>
    <div class="nav-arrow"></div>
    <div class="nav-items">
      <a class="nav-item nav-item-home" href="/" style="--index: 0">Home</a>

      
      <a class="nav-item" target="_blank" rel="noopener" href="https://aeilot.top/" style="--index: 1">Portfolio</a>
      
      <a class="nav-item" href="/archives" style="--index: 2">Archives</a>
      
      <a class="nav-item" href="/about" style="--index: 3">About</a>
      
      <a class="nav-item is-icon" href="/search" style="--index: 4"><i class="bi bi-search"></i></a>
      
    </div>
  </div>
</nav>

    <main id="main-content" data-pagefind-body>
      
<article class="post">
  
  <div class="meta">
    
    <div class="categories text-uppercase">
    
      <a href="/categories/EN-CSAPP/">EN | CSAPP</a>
    
    </div>
    

    
    <time class="date" datetime="2026-02-04T11:45:09-05:00">
      February 4, 2026
    </time>
    

    <h1 class="title" data-pagefind-meta="title">CSAPP Cache Lab I: Let&#39;s simulate a cache memory!</h1>
  </div>

  <div class="content">
    <p>For the CSAPP Cache Lab, the students are asked to write a small C program (200~300 lines) that simulates a cache memory.</p>
<p>The full code is <a target="_blank" rel="noopener" href="https://github.com/aeilot/CSAPP-Labs/blob/main/cache/csim.c">here</a> on GitHub.</p>
<h2 id="understanding-a-cache"><a class="markdownIt-Anchor" href="#understanding-a-cache"></a> Understanding a Cache</h2>
<h3 id="1-the-anatomy-of-a-cache-s-e-b-m"><a class="markdownIt-Anchor" href="#1-the-anatomy-of-a-cache-s-e-b-m"></a> 1. The Anatomy of a Cache (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>)</h3>
<p>A cache can be described with the following four parameters:</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msup><mn>2</mn><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">S = 2^s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span> (Cache Sets):  The cache is divided into sets.</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> (Cache Lines per set): This is the “associativity.”
<ul>
<li>If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">E=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, it’s a <strong>direct-mapped</strong> cache. If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">E&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, it’s <strong>set-associative</strong>.</li>
<li>Each line contains a valid bit, a tag, and the actual data block.</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><msup><mn>2</mn><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">B = 2^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span> (Block Size): The number of bytes stored in each line.
<ul>
<li>The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> bits at the end of an address tell the cache the offset within that block.</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>: The bits of the machine memory address.</li>
</ul>
<h3 id="2-address-decomposition"><a class="markdownIt-Anchor" href="#2-address-decomposition"></a> 2. Address Decomposition</h3>
<p>When the CPU wants to access a 64-bit address, the cache doesn’t look at the whole number at once. It slices the address into three distinct fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tag</strong></td>
<td>Used to uniquely identify the memory block within a specific set. <code>t = m - b - s</code></td>
</tr>
<tr>
<td><strong>Set Index</strong></td>
<td>Determines which set the address maps to.</td>
</tr>
<tr>
<td><strong>Block Offset</strong></td>
<td>Identifies the specific byte within the cache line.</td>
</tr>
</tbody>
</table>
<h3 id="3-the-search-and-match-process"><a class="markdownIt-Anchor" href="#3-the-search-and-match-process"></a> 3. The “Search and Match” Process</h3>
<p>When our simulator receives an address (e.g., from an <code>L</code> or <code>S</code> operation in the trace file), it follows these steps:</p>
<ol>
<li><strong>Find the Set:</strong> Use the set index bits to jump to the correct set in our <code>cache</code> structure.</li>
<li><strong>Search the Lines:</strong> Look through all the lines in that set.</li>
</ol>
<ul>
<li><strong>Hit:</strong> If a line has <code>valid == true</code> <strong>AND</strong> the <code>tag</code> matches the address tag.</li>
<li><strong>Miss:</strong> If no line matches.</li>
</ul>
<ol start="3">
<li><strong>Handle the Miss:</strong></li>
</ol>
<ul>
<li><strong>Cold Start:</strong> If there is an empty line (<code>valid == false</code>), fill it with the new tag and set <code>valid = true</code>.</li>
<li><strong>Eviction:</strong> If all lines are full, we must kick one out. This is where the <strong>LRU (Least Recently Used)</strong> policy comes in: we find the line that hasn’t been touched for the longest time and replace it.</li>
</ul>
<h2 id="lab-requirements"><a class="markdownIt-Anchor" href="#lab-requirements"></a> Lab Requirements</h2>
<p>For this Lab Project, we will write a cache simulator that takes a <code>valgrind</code> memory trace as an input.</p>
<h3 id="input"><a class="markdownIt-Anchor" href="#input"></a> Input</h3>
<p>The input looks like:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">I</span> <span class="number">0400</span>d7d4,<span class="number">8</span></span><br><span class="line"> <span class="attribute">M</span> <span class="number">0421</span>c7f0,<span class="number">4</span></span><br><span class="line"> <span class="attribute">L</span> <span class="number">04</span>f6b868,<span class="number">8</span></span><br><span class="line"> <span class="attribute">S</span> <span class="number">7</span>ff0005c8,<span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>Each line denotes one or two memory accesses. The format of each line is</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[space]</span>operation <span class="selector-tag">address</span>,size</span><br></pre></td></tr></table></figure>
<p>The operation field denotes the type of memory access:</p>
<ul>
<li>“I” denotes an instruction load, “L” a data load,</li>
<li>“S” a data store</li>
<li>“M” a data modify (i.e., a data load followed by a data store).</li>
</ul>
<p><strong>Mind you:</strong> There is never a space before each “I”. There is always a space before each “M”, “L”, and “S”.</p>
<p>The address field specifies a 64-bit hexadecimal memory address. The size field specifies the number of bytes accessed by the operation.</p>
<h3 id="cli"><a class="markdownIt-Anchor" href="#cli"></a> CLI</h3>
<p>Our program should take the following command line arguments:</p>
<p>Usage: <code>./csim-ref [-hv] -s &lt;s&gt; -E &lt;E&gt; -b &lt;b&gt; -t &lt;tracefile&gt;</code></p>
<ul>
<li><code>-h</code>: Optional help flag that prints usage info</li>
<li><code>-v</code>: Optional verbose flag that displays trace info</li>
<li><code>-s &lt;s&gt;</code>: Number of set index bits (S = 2s is the number of sets)</li>
<li><code>-E &lt;E&gt;</code>: Associativity (number of lines per set)</li>
<li><code>-b &lt;b&gt;</code>: Number of block bits (B = 2b is the block size)</li>
<li><code>-t &lt;tracefile&gt;</code>: Name of the valgrind trace to replay</li>
</ul>
<h3 id="caveats"><a class="markdownIt-Anchor" href="#caveats"></a> Caveats</h3>
<p>For this lab, we ignore all <code>I</code>s (the instruction cache accesses).</p>
<p>We assume that memory accesses are aligned properly, such that a single memory access never crosses block boundaries.</p>
<h2 id="the-codes"><a class="markdownIt-Anchor" href="#the-codes"></a> The Codes</h2>
<p>We basically start from scratch, given an almost blank <code>csim.c</code> file to fill in. The file comes with only a main function and no header files.</p>
<h3 id="data-models"><a class="markdownIt-Anchor" href="#data-models"></a> Data Models</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Data Model</span></span><br><span class="line"><span class="type">char</span>* fileName = <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">int</span> set_bit = <span class="number">-1</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> sets = <span class="number">-1</span>;</span><br><span class="line"><span class="type">int</span> associativity = <span class="number">-1</span>;</span><br><span class="line"><span class="type">int</span> block_bit = <span class="number">-1</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> block_size = <span class="number">-1</span>;</span><br><span class="line"><span class="type">bool</span> verboseMode = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> global_timer = <span class="number">0</span>; <span class="comment">// For LRU</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> memory_bit = <span class="number">64</span>; <span class="comment">// Assuming 64-bit addresses</span></span><br><span class="line"><span class="type">int</span> tag_bit = <span class="number">0</span>; <span class="comment">// Tag bits</span></span><br></pre></td></tr></table></figure>
<h3 id="handling-command-line-arguments"><a class="markdownIt-Anchor" href="#handling-command-line-arguments"></a> Handling Command-Line Arguments</h3>
<p>First, we add the <code>int argc, char** argv</code> parameters to the main function. <code>argc</code> stands for argument count, while <code>argv</code> stands for argument values.</p>
<p>We use <code>getopt</code> to parse arguments.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">handleArgs</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span>&#123;</span><br><span class="line">    <span class="type">int</span> opt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((opt = getopt(argc, argv, <span class="string">&quot;hvs:E:b:t:&quot;</span>)) != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span>(opt) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">                printUsage(argv);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">                verboseMode = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">                fileName = optarg;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">                set_bit = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">                associativity = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">                block_bit = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;?&#x27;</span>:</span><br><span class="line">                printUsage(argv);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">1</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(fileName == <span class="literal">NULL</span> || set_bit == <span class="number">-1</span> || associativity == <span class="number">-1</span> || block_bit == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Missing required command line argument&quot;</span>);</span><br><span class="line">        printUsage(argv);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sets = <span class="number">1LL</span> &lt;&lt; set_bit;</span><br><span class="line">    block_size = <span class="number">1LL</span> &lt;&lt; block_bit;</span><br><span class="line">    </span><br><span class="line">    tag_bit = memory_bit - (set_bit + block_bit);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>getopt</code> comes in <code>unistd.h</code>, but the compiler option is set to <code>-std=c99</code>, which hides all POSIX extensions. GNU systems provide a standalone <code>&lt;getopt.h&gt;</code> header. So we include <code>getopt.h</code> instead.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opt = getopt(argc, argv, <span class="string">&quot;hvs:E:b:t:&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>h</code> and <code>v</code>: These are boolean flags.</li>
<li><code>s:</code>, <code>E:</code>, <code>b:</code>, and <code>t:</code>: These are required arguments. The colon tells getopt that these flags must be followed by a value (e.g., -s 4).</li>
</ul>
<p>After parsing the arguments, we set the initial value of our Cache Data Model.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sets = <span class="number">1LL</span> &lt;&lt; set_bit;</span><br><span class="line">block_size = <span class="number">1LL</span> &lt;&lt; block_bit;</span><br><span class="line"></span><br><span class="line">tag_bit = memory_bit - (set_bit + block_bit);</span><br></pre></td></tr></table></figure>
<h3 id="initialize-cache"><a class="markdownIt-Anchor" href="#initialize-cache"></a> Initialize Cache</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cache Line Structure</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">CacheLine</span> &#123;</span></span><br><span class="line">    <span class="type">bool</span> valid;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> tag;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        Need LRU stamp to implement LRU eviction policy</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="type">int</span> lru_counter;</span><br><span class="line">&#125; CacheLine;</span><br><span class="line"></span><br><span class="line">CacheLine** cache = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">initCache</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// Initialize cache data structures</span></span><br><span class="line">    cache = (CacheLine**) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(CacheLine*) * sets);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;sets; i++)&#123;</span><br><span class="line">        cache[i] = (CacheLine*) <span class="built_in">calloc</span>(associativity, <span class="keyword">sizeof</span>(CacheLine));</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Caution</strong>: <code>malloc</code> has to be initialized. Or the data might contain garbage values.</p>
<p>So we use <code>calloc</code>. The <code>calloc</code> (stands for contiguous allocation) function is similar to <code>malloc</code> but it initializes the allocated memory to zero.</p>
<p>And <strong>don’t forget to free the allocated memory!</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">freeCache</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// Free allocated memory for cache</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;sets; i++) <span class="built_in">free</span>(cache[i]);</span><br><span class="line">    <span class="built_in">free</span>(cache);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="handling-file-input"><a class="markdownIt-Anchor" href="#handling-file-input"></a> Handling File Input</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// Handle trace file</span></span><br><span class="line">  FILE *traceFile = fopen(fileName, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (traceFile == <span class="literal">NULL</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Error opening file: %s\n&quot;</span>, fileName);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">char</span> operation;</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> address;</span><br><span class="line">  <span class="type">int</span> size;</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">fscanf</span>(traceFile, <span class="string">&quot; %c %llx,%d&quot;</span>, &amp;operation, &amp;address, &amp;size) == <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (operation) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">              <span class="comment">// Handle load operation</span></span><br><span class="line">              loadData(address, size);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">              <span class="comment">// Handle store operation</span></span><br><span class="line">              storeData(address, size);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;M&#x27;</span>:</span><br><span class="line">              <span class="comment">// Handle modify operation</span></span><br><span class="line">              modifyData(address, size);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">default</span>:</span><br><span class="line">              <span class="comment">// Ignore other operations</span></span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Close trace file</span></span><br><span class="line">fclose(traceFile);</span><br></pre></td></tr></table></figure>
<p><strong>Caution:</strong></p>
<ol>
<li><code>fscanf</code> does not skip spaces before <code>%c</code>, so we add a space before <code>%c</code> in the format string.</li>
<li><code>!feof(traceFile)</code> does not work correctly <a target="_blank" rel="noopener" href="http://here.It">here.It</a> only returns true <strong>after</strong> a read operation has already attempted to go past the end of the file and failed. Using it as a loop condition (e.g., <code>while (!feof(p))</code>) causes an <strong>“off-by-one”</strong> error, where the loop executes one extra time with garbage data from the last successful read.</li>
</ol>
<h3 id="parsing-addresses"><a class="markdownIt-Anchor" href="#parsing-addresses"></a> Parsing Addresses</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Parse Line Structure</span></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">getTag</span><span class="params">(<span class="type">long</span> <span class="type">long</span> address)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> address &gt;&gt; (set_bit + block_bit);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">getSetIndex</span><span class="params">(<span class="type">long</span> <span class="type">long</span> address)</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> mask = (<span class="number">1LL</span> &lt;&lt; set_bit) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> (address &gt;&gt; block_bit) &amp; mask;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">getBlockOffset</span><span class="params">(<span class="type">long</span> <span class="type">long</span> address)</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> mask = (<span class="number">1LL</span> &lt;&lt; block_bit) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> address &amp; mask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We use bit masks to parse the addresses.</p>
<h3 id="loading-cache"><a class="markdownIt-Anchor" href="#loading-cache"></a> Loading Cache</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">loadData</span><span class="params">(<span class="type">long</span> <span class="type">long</span> address, <span class="type">int</span> size)</span> &#123;</span><br><span class="line">    <span class="comment">// Simulate accessing data at the given address</span></span><br><span class="line">    <span class="type">int</span> s = getSetIndex(address);</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> t = getTag(address);</span><br><span class="line">    global_timer++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; associativity; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cache[s][i].valid &amp;&amp; cache[s][i].tag == t) &#123;</span><br><span class="line">            hit_count++;</span><br><span class="line">            cache[s][i].lru_counter = global_timer;</span><br><span class="line">            <span class="keyword">if</span> (verboseMode) <span class="built_in">printf</span>(<span class="string">&quot; hit&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    miss_count++;</span><br><span class="line">    <span class="keyword">if</span> (verboseMode) <span class="built_in">printf</span>(<span class="string">&quot; miss&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; associativity; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!cache[s][i].valid) &#123;</span><br><span class="line">            cache[s][i].valid = <span class="literal">true</span>;</span><br><span class="line">            cache[s][i].tag = t;</span><br><span class="line">            cache[s][i].lru_counter = global_timer; </span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    eviction_count++;</span><br><span class="line">    <span class="keyword">if</span> (verboseMode) <span class="built_in">printf</span>(<span class="string">&quot; eviction&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> victim_index = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> min_lru = cache[s][<span class="number">0</span>].lru_counter;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; associativity; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cache[s][i].lru_counter &lt; min_lru) &#123;</span><br><span class="line">            min_lru = cache[s][i].lru_counter;</span><br><span class="line">            victim_index = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cache[s][victim_index].tag = t;</span><br><span class="line">    cache[s][victim_index].lru_counter = global_timer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The code simulates the process of loading cache.</p>
<p>We first check if the data already exists in the cache.</p>
<p>If it doesn’t exist, we have to scan for blank lines to load the data.</p>
<p>If blank lines don’t exist, we need to evict a line using the LRU strategy. We replace the victim line with the new line.</p>
<h3 id="other-operations"><a class="markdownIt-Anchor" href="#other-operations"></a> Other Operations</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">storeData</span><span class="params">(<span class="type">long</span> <span class="type">long</span> address, <span class="type">int</span> size)</span> &#123;</span><br><span class="line">    <span class="comment">// Simulate storing data at the given address</span></span><br><span class="line">    loadData(address, size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">modifyData</span><span class="params">(<span class="type">long</span> <span class="type">long</span> address, <span class="type">int</span> size)</span> &#123;</span><br><span class="line">    <span class="comment">// Simulate modifying data at the given address</span></span><br><span class="line">    loadData(address, size);</span><br><span class="line">    hit_count++;</span><br><span class="line">    <span class="keyword">if</span> (verboseMode) <span class="built_in">printf</span>(<span class="string">&quot; hit\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For this simulator, storing data and modifying data are basically the same thing as loading data.</p>
<h3 id="print-summary"><a class="markdownIt-Anchor" href="#print-summary"></a> Print Summary</h3>
<p>We are asked to output the answer using the <code>printSummary</code> function.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Print Summary</span></span><br><span class="line">printSummary(hit_count, miss_count, eviction_count);</span><br></pre></td></tr></table></figure>
<p>And <strong>Voila</strong>!</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">                        <span class="attribute">Your</span> simulator     Reference simulator</span><br><span class="line"><span class="attribute">Points</span> (s,E,b)    Hits  Misses  Evicts    Hits  Misses  Evicts</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)       <span class="number">9</span>       <span class="number">8</span>       <span class="number">6</span>       <span class="number">9</span>       <span class="number">8</span>       <span class="number">6</span>  traces/yi2.trace</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">4</span>,<span class="number">2</span>,<span class="number">4</span>)       <span class="number">4</span>       <span class="number">5</span>       <span class="number">2</span>       <span class="number">4</span>       <span class="number">5</span>       <span class="number">2</span>  traces/yi.trace</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">2</span>,<span class="number">1</span>,<span class="number">4</span>)       <span class="number">2</span>       <span class="number">3</span>       <span class="number">1</span>       <span class="number">2</span>       <span class="number">3</span>       <span class="number">1</span>  traces/dave.trace</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>)     <span class="number">167</span>      <span class="number">71</span>      <span class="number">67</span>     <span class="number">167</span>      <span class="number">71</span>      <span class="number">67</span>  traces/trans.trace</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)     <span class="number">201</span>      <span class="number">37</span>      <span class="number">29</span>     <span class="number">201</span>      <span class="number">37</span>      <span class="number">29</span>  traces/trans.trace</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)     <span class="number">212</span>      <span class="number">26</span>      <span class="number">10</span>     <span class="number">212</span>      <span class="number">26</span>      <span class="number">10</span>  traces/trans.trace</span><br><span class="line">     <span class="attribute">3</span> (<span class="number">5</span>,<span class="number">1</span>,<span class="number">5</span>)     <span class="number">231</span>       <span class="number">7</span>       <span class="number">0</span>     <span class="number">231</span>       <span class="number">7</span>       <span class="number">0</span>  traces/trans.trace</span><br><span class="line">     <span class="attribute">6</span> (<span class="number">5</span>,<span class="number">1</span>,<span class="number">5</span>)  <span class="number">265189</span>   <span class="number">21775</span>   <span class="number">21743</span>  <span class="number">265189</span>   <span class="number">21775</span>   <span class="number">21743</span>  traces/long.trace</span><br><span class="line">    <span class="attribute">27</span></span><br></pre></td></tr></table></figure>
<h2 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h2>
<p>In this project, we moved from the theory of hierarchy to the practical reality of memory management. By building this simulator, we reinforced several core concepts of computer systems.</p>
<p>With our simulator passing all the trace tests, we’ve effectively mirrored how a CPU “thinks” about memory. The next step is applying these insights to optimize actual code, ensuring our algorithms play nicely with the hardware we’ve just simulated.</p>

  </div>

  
  <div class="about" data-pagefind-ignore>
    <h2>About this Post</h2>
    <div class="details">This post is written by Louis C Deng, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</div>
    
    <p class="tags">
      <i class="bi bi-tags icon"></i>
      
      <a href="/tags/CSAPP/" class="tag">#CSAPP</a>
      
      <a href="/tags/Lab-Notes/" class="tag">#Lab Notes</a>
      
      <a href="/tags/Architecture/" class="tag">#Architecture</a>
      
    </p>
    
    
  </div>
  

  <div class="container post-prev-next" data-pagefind-ignore>
    
    <a href="/2026/02/04/csapp-cache-lab-2/" class="next">
      <div class="text">
        <p class="label">Next</p>
        <h3 class="title">CSAPP Cache Lab II: Optimizing Matrix Transposition</h3>
      </div>
    </a>
    
    
    <a href="/2026/01/27/cs188-local-search/" class="prev">
      <div class="text">
        <p class="label">Previous</p>
        <h3 class="title">CS188 Search Lecture Notes III</h3>
      </div>
    </a>
    
  </div>

  
    <script src="https://giscus.app/client.js"
        data-repo="aeilot/blog"
        data-repo-id="MDEwOlJlcG9zaXRvcnkyNjEwODA2OTY="
        data-category="General"
        data-category-id="DIC_kwDOD4_GeM4B_VIn"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

  
</article>


    </main>
    <footer>
  <div class="inner">
    <div class="links">
      
      <div class="group">
        <h2 class="title">Blog</h2>
        
        <a href="/" class="item">Home</a>
        
        <a href="/archives" class="item">Archives</a>
        
        <a href="/tags" class="item">Tags</a>
        
        <a href="/categories" class="item">Categories</a>
        
        <a href="/search" class="item">Search</a>
        
        <a href="/index.xml" class="item">RSS</a>
        
      </div>
      
      <div class="group">
        <h2 class="title">Links</h2>
        
        <a target="_blank" rel="noopener" href="https://aeilot.top" class="item">Portfolio</a>
        
        <a target="_blank" rel="noopener" href="https://github.com/aeilot" class="item">GitHub</a>
        
        <a target="_blank" rel="noopener" href="https://www.instagram.com/aeilotd/" class="item">Instagram</a>
        
        <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/chenluo-d-85b37a33a/" class="item">LinkedIn</a>
        
      </div>
      
      <div class="group">
        <h2 class="title">Friends</h2>
        
        <a target="_blank" rel="noopener" href="https://mrwillcom.now.sh" class="item">Mr.Will</a>
        
        <a target="_blank" rel="noopener" href="https://chungzh.cn" class="item">ChungZH</a>
        
        <a target="_blank" rel="noopener" href="https://shaojiaxu.github.io" class="item">SJX</a>
        
        <a target="_blank" rel="noopener" href="http://clckblog.space/" class="item">CLCK</a>
        
        <a target="_blank" rel="noopener" href="https://innei.in/" class="item">静かな森</a>
        
      </div>
      
    </div>
    <span>&copy; 2026 Louis C Deng<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></span>
    
    
      <br>
      <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
        <label>
          <input type="radio" value="light">
          <span>Light</span>
        </label>
        <label>
          <input type="radio" value="dark">
          <span>Dark</span>
        </label>
        <label>
          <input type="radio" value="auto">
          <span>Auto</span>
        </label>
      </div>
    
  </div>
</footer>


    
<script src="/js/main.js"></script>


    

    
    
<script src="/js/scroll-reveal.js"></script>

    

    <style>
  .giscus {
    max-width: 768px;
    padding: 16px;
    margin: 64px auto;
    
    background: var(--color-background-secondary); 
    border-radius: var(--radius-medium); 
  }


  @media (max-width: 800px) {
      .giscus {
          border-radius: 0;
          width: auto;
      }
  }

  @container document-body style(--config-corner-squircle: true) {
      @supports (corner-shape: squircle) {
          .giscus {
              corner-shape: squircle;
              --radius-tiny: 10px;
              --radius-small: 20px;
              --radius-medium: 30px;
              --radius-large: 40px;
              --radius-full: 999px;
          }
      }
  }

  @media (max-width: 768px) {
    .giscus {
      margin: 20px 10px; 
      padding: 20px;
    }
  }
</style>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
